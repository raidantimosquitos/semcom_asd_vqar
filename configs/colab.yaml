# Colab / IDE Colab kernel: longer epochs, paths relative to project root.
# When using IDE with Colab kernel, project root is the working dir; no clone needed.
# The notebook overrides data.root_dir, checkpoints.dir, and log_dir from its config cell.
#
# Checkpoint layout: checkpoints/{models,stats}/

mode: train

checkpoints:
  dir: "./checkpoints"

data:
  root_dir: "/content/drive/MyDrive/datasets/dcase2020-task2-dev-dataset"  # overridden by notebook
  appliance: fan
  test_size: 0.1
  batch_size: 32
  random_state: 42
  max_samples_stats: null

device: cuda

# Phase 1: VQ-VAE (optionally 3 sub-phases with MachineID classifier)
phase1:
  num_epochs: 10  # used only when phase1a_epochs not set (single-phase VQ-VAE only)
  # Three-phase schedule: 1a = VQ-VAE only, 1b = VQ-VAE + classifier, 1c = frozen codebook + recon + classifier
  phase1a_epochs: 10  # e.g. 30; null = use num_epochs and skip 1b/1c
  phase1b_epochs: 20  # e.g. 50
  phase1c_epochs: 15  # e.g. 20
  lambda_1: 1.0   # weight for VQ-VAE loss (recon + vq)
  lambda_2: 0.5   # weight for machine_id classifier CE loss (phases 1b/1c)
  lr: 0.001
  checkpoint: "checkpoints/models/mobilenetv2_8x_vqvae.pth"
  classifier_checkpoint: "checkpoints/models/machine_id_classifier.pth"

phase2:
  num_epochs: 80
  lr: 0.0002
  checkpoint: "./checkpoints/models/pixelsnail_prior.pth"

eval:
  vqvae_checkpoint: "./checkpoints/models/mobilenetv2_8x_vqvae.pth"
  prior_checkpoint: "./checkpoints/models/pixelsnail_prior.pth"

logging:
  log_dir: "./logs"
  name: "main"
